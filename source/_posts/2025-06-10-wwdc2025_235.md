---
title: 进一步了解声明式网页推送
date: 2025-06-10 15:29:38
categories:
- wwdc2025
tags:
- wwdc2025
- ios
- ipados
- macos
- visionos
- safari-浏览器和网页
---
了解声明式网页推送如何帮助你更可靠地发送通知。了解如何借鉴现有标准实现更高效、更透明的设计，同时保证与原始网页推送的向后兼容性。
<!--more-->

![视频封面](https://devimages-cdn.apple.com/wwdc-services/images/3055294D-836B-4513-B7B0-0BC5666246B0/9933/9933_wide_250x141_2x.jpg)
[视频地址](https://developer.apple.com/cn/videos/play/wwdc2025/235/)

# 声明式网页推送：更高效可靠的通知解决方案

## 引言
推送通知已成为现代数字体验的核心功能。无论是在原生应用还是网页中，它都扮演着至关重要的角色。苹果早在2009年就开始构建推送通知系统，而现在，Web标准社区正在通过声明式网页推送来重新定义网页推送的未来。

## 传统网页推送的局限性
传统Web Push规范完全依赖JavaScript代码驱动：
1. 需要开发者在Service Worker中编写处理逻辑
2. 代码执行带来性能开销
3. 存在潜在的隐私安全风险
4. 智能防追踪(ITP)限制了JS的生命周期

## 声明式推送的核心理念
声明式网页推送借鉴了原生推送系统的成功经验：
- **无需代码编写**：采用标准化JSON格式描述通知
- **更高效率**：浏览器直接解析处理，无需JS执行
- **更好兼容性**：与现有Web Push标准保持向后兼容
- **渐进增强**：在不支持的浏览器中自动回退传统方式

## 技术实现对比

### 传统Web Push流程
1. 获取推送订阅
2. 服务器发送消息到订阅URL
3. 浏览器唤醒Service Worker
4. Service Worker处理push事件并调用showNotification
5. 用户点击触发notificationclick事件

### 声明式Web Push流程
1. 获取推送订阅（可通过window.PushManager）
2. 服务器发送标准化JSON消息
3. 浏览器自动验证并显示通知
4. 用户点击自动打开指定URL

## 声明式JSON格式详解
最小化示例：
```json
{
  "web_push": "8-0-3-0",
  "notification": {
    "title": "您有新消息",
    "data": {
      "url": "https://example.com"
    }
  }
}
```

完整支持W3C NotificationOptions的所有选项：
- 消息正文
- 通知标签
- 系统提示音
- 应用角标更新

## 高级定制能力
对于需要额外处理的场景：
1. 在JSON中添加"mutable":true标记
2. Service Worker将收到推送事件
3. 可以进行消息解密或内容修正
4. 处理失败时回退原始通知

## 迁移与兼容性策略
现有Web Push应用可轻松迁移：
1. 重命名现有JSON属性为标准格式
2. 添加"web_push"魔法键
3. 简化Service Worker中的处理逻辑
4. 新旧浏览器自动获得最佳体验

## 结语
声明式网页推送代表了Web通知技术的未来方向，它结合了原生推送的可靠性和Web的开放性。现在就是开始采用这一新技术的最佳时机，无论是新建项目还是现有应用的升级。

## 相关视频
- [在网页上验证身份证件](https://developer.apple.com/videos/play/wwdc2025/232)
- [Safari浏览器和WebKit的新功能](https://developer.apple.com/videos/play/wwdc2025/233)
- [Safari浏览器网页推送功能简介](https://developer.apple.com/videos/play/wwdc2022/10098)
> 此文章由AI生成，可能存在错误，如有问题，请联系[djs66256@163.com](djs66256@163.com)
---
title: 深入探索适用于 App 内购买项目的 App Store Server API
date: 2025-06-10 21:46:47
categories:
- wwdc2025
tags:
- wwdc2025
- ios
- ipados
- macos
- tvos
- visionos
- watchos
- app-服务
---
了解 app store server api、app store 服务器通知以及 app store server 资源库如何帮助你直接在服务器上管理顾客购买数据，并提供卓越的 app 内购买项目体验。我们将介绍 appaccounttoken 和签名流程的最新更新、签名交易和续订信息的新字段，以及一些全新 api。然后，我们将展示如何在服务器上生成促销优惠签名，以及如何使用 send consumption information 端点。
<!--more-->

![视频封面](https://devimages-cdn.apple.com/wwdc-services/images/3055294D-836B-4513-B7B0-0BC5666246B0/9939/9939_wide_250x141_2x.jpg)
[视频地址](https://developer.apple.com/cn/videos/play/wwdc2025/249/)
> 此文章由AI生成，可能存在错误，如有问题，请联系[djs66256@163.com](djs66256@163.com)

# App 内购买项目的 App Store 服务器 API 深度解析

## 引言

每年 WWDC 都为我们带来 Apple 生态系统中各类技术的更新与改进。在 2025 年的 WWDC 上，App Store 服务器团队展示了关于 App 内购买项目 API 的一系列重要更新。这些改进将帮助开发者更高效地管理应用内购买，优化服务器端流程，并提升用户体验。

## 核心职责概述

应用服务器在 App 内购买生态系统中扮演着关键角色，主要有三大核心职责：

1. **管理 App 内购买项目**：包括将交易数据与客户账户关联，确保应用能够无缝提供内容和服务。
2. **签名请求**：生成签名以授权服务器向 App Store 发起的请求。
3. **参与退款决策流程**：通过分享消费数据帮助 App Store 做出明智的退款决策。

## 管理 App 内购买项目

### 客户账户关联

有效处理客户账户是管理 App 内购买项目的首要任务。开发者通常会在系统中为每个客户分配唯一的账户 ID，从而在其账户与 App Store 交易之间建立明确关联。这种关联对于提供正确内容或个性化用户体验至关重要。

### 数据结构解析

App Store 通过三种关键数据结构提供 App 内购买数据：

1. **AppTransaction**：包含应用级别的交易信息
2. **JWSTransaction**：代表已签名的交易对象
3. **JWSRenewalInfo**：包含订阅续订相关信息

其中，**JWSTransaction** 是处理单个购买的核心数据结构。当客户完成 App 内购买时，App Store 会提供已签名的交易对象，服务器端可以使用 App Store 服务器库对其进行验证和解码。

### JWSTransaction 字段解析

解码后的 signedTransactionInfo 包含以下重要信息：

**基础信息**：
- 应用相关信息
- App 内产品类型

**购买元数据**：
- 购买数量
- 价格信息
- 货币类型

**优惠信息**（如果客户兑换了优惠）：
- offerType：优惠类型
- offerIdentifier：优惠标识符
- offerDiscountType：优惠折扣类型

**新增字段**：
- offerPeriod：采用 ISO 8601 持续时间格式表示兑换优惠的有效期（该字段也存在于 JWSRenewalInfo 中）

**交易标识符**：
- transactionId：交易的唯一标识符，适用于 App 内购买、恢复或订阅续订

## 相关资源

### 视频资源
[StoreKit 和 App 内购买项目的新功能](https://developer.apple.com/videos/play/wwdc2025/241)  
[探索适用于 App 内购买项目的 App Store Server API](https://developer.apple.com/videos/play/wwdc2024/10062)

### 文档资源
[高级商业 API](https://developer.apple.com/in-app-purchase/advanced-commerce-api/)  
[App Store 服务器 API](https://developer.apple.com/documentation/AppStoreServerAPI)  
[App Store 服务器通知](https://developer.apple.com/documentation/appstoreservernotifications)  
[设置应用账户令牌](https://developer.apple.com/documentation/AppStoreServerAPI/Set-App-Account-Token)  
[使用 App Store 服务器库简化实现](https://developer.apple.com/documentation/AppStoreServerAPI/simplifying-your-implementation-by-using-the-app-store-server-library)  
[提交反馈](http://feedbackassistant.apple.com)

## 总结

本次 WWDC 介绍的 App Store 服务器 API 更新为开发者提供了更强大的工具来管理应用内购买。通过优化交易标识符、简化签名流程以及增强退款决策参与机制，开发者将能够构建更加可靠和高效的应用内购买系统。建议开发者仔细研究相关文档和视频资源，充分利用这些新特性来提升用户体验和业务运营效率。

---
title: 使用 PermissionKit 增强儿童安全保护
date: 2025-06-10 15:27:31
categories:
- wwdc2025
tags:
- wwdc2025
- ios
- ipados
- macos
- app-服务
---
了解 permissionkit 如何帮助你的 app 增强儿童通信安全。我们将向你展示如何使用这一全新框架来创建适龄通信体验，并利用“家人共享”请求获得家长批准。你将了解如何构建与“信息”无缝整合的权限请求、处理家长答复，并为儿童用户量身定制 ui。为了充分从这个讲座中获益，我们建议你先观看 wwdc25 讲座“在你的 app 中提供适龄体验”视频。
<!--more-->

![视频封面](https://devimages-cdn.apple.com/wwdc-services/images/3055294D-836B-4513-B7B0-0BC5666246B0/9997/9997_wide_250x141_2x.jpg)
[视频地址](https://developer.apple.com/cn/videos/play/wwdc2025/293/)

# 使用 PermissionKit 为儿童通信安全保驾护航

## 引言
在数字时代，保护儿童上网安全已成为开发者的重要责任。苹果最新推出的 PermissionKit 框架为开发者提供了一套完整的解决方案，通过"信息"应用建立亲子沟通桥梁，让家长能够直接审批孩子的通信请求。本文将详细介绍如何利用这一技术构建更安全的儿童通信环境。

## PermissionKit 框架概述
PermissionKit 是 iOS/iPadOS/macOS 26 中的全新框架，专为标准化权限流程设计。其核心价值在于：
- 利用"信息"作为天然沟通渠道
- 支持儿童向父母/监护人申请新联系人权限
- 提供家长直接审批的便捷体验

## 实施前注意事项
在集成 PermissionKit 前需确认：
1. 用户需加入"家人共享"群组
2. 家长需为孩子启用"通信限制"功能
3. 若不符合条件，API 将返回默认响应

## 儿童界面定制方案
针对儿童用户的安全界面设计要点：

```swift
import PermissionKit

let knownHandles = await CommunicationLimits.current.knownHandles(in: conversation.participants)

if knownHandles.isSuperset(of: conversation.participants) {
    // 显示完整内容
} else {
    // 隐藏敏感信息
}
```
通过 `knownHandles(in:)` 方法识别已知联系人，动态调整界面展示逻辑。

## 构建权限申请流程
分步骤创建完整的通信权限申请：

1. **基础请求创建**
```swift
var question = PermissionQuestion(handles: [
    CommunicationHandle(value: "dragonslayer42", kind: .custom),
    CommunicationHandle(value: "progamer67", kind: .custom)
])
```

2. **增强元数据支持**
```swift
let people = [
    PersonInformation(
        handle: CommunicationHandle(value: "dragonslayer42", kind: .custom),
        nameComponents: nameComponents,
        avatarImage: profilePic
    )
]
var topic = CommunicationTopic(personInformation: people)
topic.actions = [.message]
var question = PermissionQuestion(communicationTopic: topic)
```

3. **界面集成方案**
- SwiftUI 实现：
```swift
CommunicationLimitsButton(question: question) {
    Label("申请权限", systemImage: "paperplane")
}
```
- UIKit 实现：
```swift
try await CommunicationLimits.current.ask(question, in: viewController)
```
- AppKit 实现：
```swift
try await CommunicationLimits.current.ask(question, in: window)
```

## 家长响应处理机制
通过 AsyncSequence 实时监听家长答复：

```swift
.task {
    let updates = CommunicationLimits.current.updates
    for await update in updates {
        // 更新界面状态
        self.isShowingResponseAlert = true
    }
}
```

## 完整工作流程演示
1. 儿童端隐藏未知联系人内容
2. 触发权限申请按钮
3. 系统自动生成信息请求
4. 家长端审批操作
5. 儿童端实时接收响应

## 扩展安全方案
苹果生态提供的完整儿童保护方案：
- 敏感内容分析 API
- Declared Age Range API
- 屏幕使用时间框架
- 家庭控制框架

## 实施路线建议
1. 确定用户年龄区间
2. 适配儿童友好界面
3. 集成 PermissionKit 流程

## 相关视频
- [在你的 App 中提供适龄体验](https://developer.apple.com/videos/play/wwdc2025/299)

## 文档
- [DeclaredAgeRange 文档](https://developer.apple.com/documentation/DeclaredAgeRange)
- [PermissionKit 文档](https://developer.apple.com/documentation/PermissionKit)
> 此文章由AI生成，可能存在错误，如有问题，请联系[djs66256@163.com](djs66256@163.com)
---
title: 开始使用适用于 Apple 芯片的 MLX
date: 2025-06-10 15:43:14
categories:
- wwdc2025
tags:
- wwdc2025
- ios
- ipados
- macos
- 机器学习与-ai
---
mlx 是一个灵活高效的阵列框架，适用于 apple 芯片上的数字计算和机器学习。我们将探索统一内存、懒性计算和函数转换等基本功能。我们还将了解一些有关使用 swift 和 python api 来构建和加速支持不同 apple 平台的机器学习模型的更高级技巧。
<!--more-->

![视频封面](https://devimages-cdn.apple.com/wwdc-services/images/3055294D-836B-4513-B7B0-0BC5666246B0/10026/10026_wide_250x141_2x.jpg)
[视频地址](https://developer.apple.com/cn/videos/play/wwdc2025/315/)

# 在 Apple 芯片上使用 MLX 加速机器学习

## 简介

MLX 是一个专为 Apple 芯片优化的高性能阵列框架，适用于从基础数值计算到大规模机器学习模型的各类任务。本文将带您了解 MLX 的核心特性、性能优化技巧以及如何在 Swift 和 Python 中使用 MLX 来加速您的机器学习工作流程。

## MLX 概览

MLX 专为 Apple Silicon 设计，具有以下特点：
- 可在 CPU 或 GPU 加速模式下运行
- 核心 API 与 NumPy 高度兼容
- 提供完整的机器学习工具链，包括自动微分和高级库
- 高级 API 设计类似 PyTorch 和 JAX，易于上手

安装 MLX 非常简单，只需在终端执行：
```python
pip3 install mlx
```

基础使用示例：
```python
import mlx.core as mx

a = mx.array([1, 2, 3])
b = mx.array([4, 5, 6])
c = a + b
```

## 核心特性

### 统一内存架构
MLX 充分利用 Apple Silicon 的 CPU/GPU 共享内存架构：
```python
# GPU执行
c = mx.add(a, b, stream=mx.gpu)  
# CPU执行
d = mx.multiply(a, b, stream=mx.cpu)  
```

### 惰性计算
MLX 采用计算图而非立即执行的模式：
```python
c = a + b  # 构建计算图
print(c)  # 触发实际计算
mx.eval(c)  # 显式求值
```

### 函数转换
支持自动微分等高级功能：
```python
dfdx = mx.grad(mx.sin)  # 求导函数
d2fdx2 = mx.grad(mx.grad(mx.sin))  # 二阶导
```

### 高级神经网络包
`mlx.nn` 提供模块化网络构建：
```python
class MLP(nn.Module):
    def __init__(self, dim, h_dim):
        super().__init__()
        self.linear1 = nn.Linear(dim, h_dim)
        self.linear2 = nn.Linear(h_dim, dim)
    
    def __call__(self, x):
        x = nn.relu(self.linear1(x))
        return self.linear2(x)
```

## 性能优化技巧

### 函数编译
使用 `@mx.compile` 装饰器优化性能：
```python
@mx.compile
def gelu(x):
    return x * (1 + mx.erf(x/math.sqrt(2))) / 2
```

### 高性能算子
`mx.fast` 提供优化实现：
```python
mx.fast.rms_norm(x, weight)  # 比原生实现快10倍
```

### 量化压缩
降低精度节省资源：
```python
quantized_w, scales, biases = mx.quantize(weight, bits=4)
nn.quantize(model, bits=4)  # 整模型量化
```

## MLX Swift

Swift API 与 Python 保持一致：
```swift
let a = MLXArray([1, 2, 3])
let c = a + b
print(c.shape)
```

## 结论

MLX 为 Apple 芯片提供了强大的机器学习加速能力，通过统一内存、惰性计算等创新设计，结合丰富的优化工具，让开发者能够在 Mac 设备上高效运行各类机器学习任务。无论您是使用 Python 进行快速原型开发，还是通过 Swift 构建高性能应用，MLX 都能提供出色的支持。

## 相关视频
- [借助 MLX 在 Apple 芯片上探索大语言模型](https://developer.apple.com/videos/play/wwdc2025/298)

## 文档资源
- [MLX 官网](https://ml-explore.github.io/mlx/)
- [MLX LM - Python API](https://github.com/ml-explore/mlx-lm)
- [MLX 核心库](https://github.com/ml-explore/mlx)
- [MLX 框架文档](https://mlx-framework.org)
- [Llama 推理示例](https://ml-explore.github.io/mlx/build/html/examples/llama-inference.html)
- [MLX Swift](https://github.com/ml-explore/mlx-swift)
> 此文章由AI生成，可能存在错误，如有问题，请联系[djs66256@163.com](djs66256@163.com)
---
title: 录制、重播和查看：使用 Xcode 实现 UI 自动化
date: 2025-06-10 15:29:52
categories:
- wwdc2025
tags:
- wwdc2025
- ios
- ipados
- macos
- tvos
- visionos
- watchos
- swift
---
了解如何在 xcode 中录制、运行和维护 xcuiautomation 测试。利用测试计划配置，在数十个语言、设备类型和系统条件下重播 xctest ui 测试。使用 xcode 测试报告来查看测试结果，并下载运行情况的截图和视频。我们还将介绍有关通过辅助功能为 app 做好自动化准备以及编写稳定、高质量自动化代码的最佳做法。
<!--more-->

![视频封面](https://devimages-cdn.apple.com/wwdc-services/images/3055294D-836B-4513-B7B0-0BC5666246B0/10029/10029_wide_250x141_2x.jpg)
[视频地址](https://developer.apple.com/cn/videos/play/wwdc2025/344/)

# 使用 Xcode 实现 UI 自动化测试：从录制到回放全攻略

## 引言
在 App 开发中，确保用户界面在不同设备和语言环境下都能正常工作至关重要。Xcode 提供了一套强大的 UI 自动化测试工具，让你可以轻松录制交互行为，在多配置环境下回放测试，并查看详细的测试报告。本文将带你全面了解 Xcode 的 UI 自动化功能。

## UI 自动化测试概述
Xcode 的 UI 自动化测试基于 XCTest 框架中的 XCUIAutomation 模块，它能模拟真实用户与 App 的交互。完整的测试套件通常包含：
- 单元测试：验证应用逻辑
- UI 测试：验证用户体验和核心工作流

UI 自动化工作流分为三个阶段：
1. 录制：将用户交互转换为代码
2. 回放：在多设备/语言环境下执行
3. 审查：查看测试结果和视频记录

## 为自动化测试准备应用

### 添加辅助功能标识符
辅助功能是自动化测试的基础，通过为 UI 元素添加标识符可以提高测试的稳定性：

```swift
// SwiftUI 示例
Image(landmark.backgroundImageName)
  .accessibilityIdentifier("LandmarkImage-\(landmark.id)")

// UIKit 示例
button.accessibilityIdentifier = "LandmarkButton-\(landmark.id)"
```

优秀标识符应具备：
- 全应用唯一性
- 描述性（说明所属元素）
- 静态性（不随内容变化）

### 使用辅助功能检查器
通过 Xcode > Open Developer Tool 启动辅助功能检查器，检查元素的可访问性属性。

## 录制交互行为
Xcode 提供一键录制功能：
1. 点击录制按钮
2. 在模拟器中操作应用
3. 停止录制生成代码

录制后生成的代码中，每个 UI 元素都有多种定位方式可选，建议优先使用辅助功能标识符而非本地化字符串。

## 多配置回放
测试计划(Test Plan)让你可以：
- 包含/排除特定测试
- 设置系统参数（语言/地区/设备方向）
- 管理超时、重复、并行等属性

配置建议：
- 添加多语言环境测试
- 设置视频/截图捕获规则
- 通过 Xcode Cloud 在云端运行测试

## 查看测试结果
测试报告提供强大功能：
- 视频播放时显示交互标记点
- 失败时刻显示所有 UI 元素状态
- 提供代码修复建议
- 支持视频下载

## 最佳实践
```swift
// 优先使用辅助功能标识符
XCUIApplication().staticTexts["Collection-1"]

// 保持查询简洁
XCUIApplication().staticTexts["Collection-1"]

// 动态内容使用通用查询
XCUIApplication().staticTexts.firstMatch
```

## 结论
Xcode 的 UI 自动化测试功能强大且易于使用，从录制交互到多环境回放，再到详细的结果分析，为开发者提供了完整的测试解决方案。通过遵循本文介绍的实践方法，你可以构建更稳定、高效的自动化测试套件。

## 相关视频
- [了解 Swift Testing](https://developer.apple.com/videos/play/wwdc2024/10179)
- [使用 Xcode 测试报告更快修复故障](https://developer.apple.com/videos/play/wwdc2023/10175)
- [在 SwiftUI 和 UIKit 中创建易于访问的 App](https://developer.apple.com/videos/play/wwdc2023/10036)

## 文档
- [通过测试计划组织测试改进代码评估](https://developer.apple.com/documentation/Xcode/organizing-tests-to-improve-feedback)
- [为应用执行辅助功能测试](https://developer.apple.com/documentation/Accessibility/performing-accessibility-testing-for-your-app)
> 此文章由AI生成，可能存在错误，如有问题，请联系[djs66256@163.com](djs66256@163.com)
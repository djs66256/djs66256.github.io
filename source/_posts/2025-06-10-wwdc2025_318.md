---
title: 与附近用户共享 visionOS 体验
date: 2025-06-10 15:54:14
categories:
- wwdc2025
tags:
- wwdc2025
- visionos
- 音频和视频
---
了解如何为同一房间内佩戴 apple vision pro 的用户打造共享体验。我们将展示如何在你的 app 中整合同播共享并充分利用 arkit，介绍与附近 facetime 通话参与者共享窗口的流程有哪些更新，并介绍旨在实现流畅协作的全新 api。探索相关最佳实践，了解如何为身处同一空间的用户打造别具特色、易于发现且引人入胜的协作功能。
<!--more-->

![视频封面](https://devimages-cdn.apple.com/wwdc-services/images/3055294D-836B-4513-B7B0-0BC5666246B0/10055/10055_wide_250x141_2x.jpg)
[视频地址](https://developer.apple.com/cn/videos/play/wwdc2025/318/)

# 在 visionOS 中实现同空间共享体验的完整指南

## 引言
苹果 visionOS 26 引入了一项令人振奋的新功能——同空间共享体验。这项技术允许在同一物理空间内的多个 Vision Pro 用户共享应用内容，共同观看、聆听或协作使用应用。无论是家庭娱乐还是团队协作，这都将带来前所未有的沉浸式互动体验。

## 基础概念：附近共享机制
visionOS 26 重新设计了应用共享流程，使其更加直观：
- 每个窗口右侧新增分享按钮
- 点击后会显示附近用户列表
- 共享窗口会精确出现在所有参与者的视野中同一位置
- 窗口栏变为绿色表示正在共享状态

系统确保所有参与者看到的窗口位置和尺寸完全同步，移动或调整窗口时会实时更新。

## SharePlay 框架整合
要实现交互式共享体验（而不仅仅是查看），需要使用 SharePlay 框架：

```swift
// 创建群组活动示例
struct BoardGameActivity: GroupActivity, Transferable {
    var metadata = GroupActivityMetadata(title: "一起玩")
}
```

沉浸式空间应用开发者需要注意：
- 保持非沉浸模式作为共享入口
- 待所有人加入后再切换至沉浸模式
- 可以使用自定义按钮触发 activate() 方法呼出共享菜单

## 高级功能实现

### 识别附近参与者
通过 GroupSession 的 activeParticipants 属性，结合 isNearbyWithLocalParticipant 标志：

```swift
func observeParticipants(session: GroupSession<BoardGameActivity>) async {
    for await activeParticipants in session.$activeParticipants.values {
        let nearbyPlayers = activeParticipants.filter { $0.isNearbyWithLocalParticipant }
    }
}
```

### 基于位置的内容布局
使用 ParticipantState.pose 属性获取参与者在沉浸式空间中的位置信息，实现更智能的内容放置。

### 媒体同步播放
visionOS 26 中 AVPlayer 新增了对同空间用户的精准同步支持：

```swift
WindowGroup(id: "教学视频") {
    InstructionalVideoView()
        .groupActivityAssociation(.primary("教学视频"))
}
```

## ARKit 共享锚点
ARKit 新增的共享世界锚点允许将虚拟内容固定在物理空间中的同一位置：

```swift
WorldAnchor(originFromAnchorTransform: transform, sharedWithNearbyParticipants: true)
```

使用前需要检查 worldAnchorSharingAvailability 状态。

## 设计建议
- 确保应用支持新的共享菜单
- 设计时要兼顾附近与远程用户
- 充分利用物理空间特性
- 考虑使用非沉浸模式作为共享入口

## 相关视频
- [了解面向空间商务 App 的增强功能](https://developer.apple.com/videos/play/wwdc2025/223)
- [自定支持同播共享的空间自影像模板](https://developer.apple.com/videos/play/wwdc2024/10201)
- [打造出色的空间播放体验](https://developer.apple.com/videos/play/wwdc2023/10070)
- [构建空间同播共享体验](https://developer.apple.com/videos/play/wwdc2023/10087)

## 文档资源
- [AVPlaybackCoordinator](https://developer.apple.com/documentation/AVFoundation/AVPlaybackCoordinator)
- [Configure your visionOS app for sharing with people nearby](https://developer.apple.com/documentation/GroupActivities/configure-your-app-for-sharing-with-people-nearby)
- [groupActivityAssociation(_:)](https://developer.apple.com/documentation/SwiftUI/View/groupActivityAssociation(_:))
> 此文章由AI生成，可能存在错误，如有问题，请联系[djs66256@163.com](djs66256@163.com)
---
title: 了解 PaperKit
date: 2025-06-10 15:27:27
categories:
- wwdc2025
tags:
- wwdc2025
- ios
- ipados
- macos
- visionos
- app-服务
---
了解如何将 paperkit 引入你的 ios、ipados、macos 以及 visionos app。我们将介绍如何将 pencilkit 绘画与标记功能 (如形状和图像) 无缝整合，以及如何自定用户界面。了解向前兼容性的最佳实践，并探索高级自定选项，以便为你的 app 打造真正与众不同的标记体验。
<!--more-->

![视频封面](https://devimages-cdn.apple.com/wwdc-services/images/3055294D-836B-4513-B7B0-0BC5666246B0/10006/10006_wide_250x141_2x.jpg)
[视频地址](https://developer.apple.com/cn/videos/play/wwdc2025/285/)

# PaperKit：为您的应用打造强大标记体验

## 引言
苹果在 WWDC 上推出了全新的 PaperKit 框架，它为开发者提供了简单易用的方式来为 iOS、iPadOS、macOS 和 visionOS 应用添加丰富的标记功能。本文将带您深入了解 PaperKit 的核心功能、集成方法和自定义选项，让您能够在应用中快速实现专业级的标记体验。

## PaperKit 核心组件

PaperKit 主要由三个关键组件构成：

1. **PaperMarkupViewController**：负责交互式创建和显示标记内容
2. **PaperMarkup**：数据模型容器，处理标记数据的保存、加载和渲染
3. **插入菜单**：提供添加各种标记元素的界面（iOS/iPadOS/visionOS 使用 MarkupEditViewController，macOS 使用 MarkupToolbarViewController）

## 快速集成指南

### iOS 平台集成

```swift
override func viewDidLoad() {
    super.viewDidLoad()
    
    let markupModel = PaperMarkup(bounds: view.bounds)
    let paperViewController = PaperMarkupViewController(markup: markupModel, supportedFeatureSet: .latest)
    view.addSubview(paperViewController.view)
    addChild(paperViewController)
    paperViewController.didMove(toParent: self)
    becomeFirstResponder()    

    let toolPicker = PKToolPicker()
    toolPicker.addObserver(paperViewController)
    
    pencilKitResponderState.activeToolPicker = toolPicker
    pencilKitResponderState.toolPickerVisibility = .visible
    
    toolPicker.accessoryItem = UIBarButtonItem(barButtonSystemItem: .add, target: self, action: #selector(plusButtonPressed(_:)))
}
```

### macOS 平台集成

```swift
override func viewDidLoad() {
    super.viewDidLoad()
    
    let markupModel = PaperMarkup(bounds: view.bounds)
    let paperViewController = PaperMarkupViewController(markup: markupModel, supportedFeatureSet: .latest)
    view.addSubview(paperViewController.view)
    addChild(paperViewController)

    let toolbarViewController = MarkupToolbarViewController(supportedFeatureSet: .latest)
    toolbarViewController.delegate = paperViewController
    view.addSubview(toolbarViewController.view)
    
    setupLayoutConstraints()
}
```

## 高级定制功能

### 自定义功能集

```swift
var featureSet: FeatureSet = .latest

featureSet.remove(.text)
featureSet.insert(.stickers)

// 启用HDR支持
featureSet.colorMaximumLinearExposure = 4
toolPicker.colorMaximumLinearExposure = 4

let paperViewController = PaperMarkupViewController(supportedFeatureSet: featureSet)
let markupEditViewController = MarkupEditViewController(supportedFeatureSet: featureSet)
```

### 自定义背景视图

```swift
let template = UIImage(named: "MyTemplate.jpg")
let templateView = UIImageView(image: template)
paperViewController.contentView = templateView
```

## 数据持久化与兼容性

### 自动保存标记更改

```swift
func paperMarkupViewControllerDidChangeMarkup(_ paperMarkupViewController: PaperMarkupViewController) {
    let markupModel = paperMarkupViewController.markup
    Task {
        let data = try await markupModel.dataRepresentation()
        try data.write(toFile: paperKitDataURL)
    }
}
```

### 处理版本兼容性

```swift
func updateThumbnail(_ markupModel: PaperMarkup) async throws {
    let thumbnailSize = CGSize(width: 200, height: 200)
    let context = makeCGContext(size: thumbnailSize)
    context.setFillColor(gray: 1, alpha: 1)
    context.fill(renderer.format.bounds)            

    await markupModel.draw(in: context, frame: CGRect(origin: .zero, size: thumbnailSize))
    
    thumbnail = context.makeImage()
}
```

## 结语
PaperKit 为开发者提供了强大而灵活的标记功能解决方案。无论是简单的笔记应用还是复杂的创意工具，通过合理利用 PaperKit 的各种定制选项，您都能打造出满足用户需求的标记体验。现在就尝试将 PaperKit 集成到您的应用中，开启全新的标记可能性吧！

## 相关视频
- [充分利用 Apple Pencil 的强大功能](https://developer.apple.com/videos/play/wwdc2024/10214)
- [PencilKit 的新功能](https://developer.apple.com/videos/play/wwdc2020/10107)
- [SwiftUI 新功能](https://developer.apple.com/videos/play/wwdc2020/10041)

## 文档
- [PaperKit 官方文档](https://developer.apple.com/documentation/PaperKit)
> 此文章由AI生成，可能存在错误，如有问题，请联系[djs66256@163.com](djs66256@163.com)
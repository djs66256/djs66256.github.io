---
title: 探索 Apple 托管的 Background Assets
date: 2025-06-10 15:27:37
categories:
- wwdc2025
tags:
- wwdc2025
- ios
- ipados
- macos
- tvos
- visionos
- app-服务
---
本次讲座将以 background assets 为基础，介绍用于为游戏和其他应用程序下载内容素材包的新功能。了解 apple 如何为你托管这些素材包，或如何管理自托管选项。我们将深入探索原生 api 整合及相应的 app store 实现，并为你提供工具来提升 app 的内容交付体验和用户体验。
<!--more-->

![视频封面](https://devimages-cdn.apple.com/wwdc-services/images/3055294D-836B-4513-B7B0-0BC5666246B0/9860/9860_wide_250x141_2x.jpg)
[视频地址](https://developer.apple.com/cn/videos/play/wwdc2025/325/)

# 利用 Apple 托管 Background Assets 优化应用资源交付

## 引言
在当今应用生态中，资源交付的效率直接影响用户体验。Apple 推出的 Background Assets 技术为开发者提供了全新的资源包管理方案，既能提升首启动体验，又能灵活更新内容而不必重新提交应用。本文将详细介绍这项技术的核心功能、实现方式以及最佳实践。

## Background Assets 的核心价值
传统资源交付方式存在明显局限：
- 主应用包内置：导致安装包过大，小更新需全包重发
- 自主托管：服务器维护成本高
- 按需资源：即将退出的遗留方案

Background Assets 提供了以下优势：
1. **独立更新**：无需提交应用即可更新单个资源文件
2. **智能下载**：系统自动处理下载调度与压缩
3. **多策略支持**：
   - 必需资源（Essential）：与安装流程集成
   - 预载资源（Prefetch）：后台自动完成
   - 按需资源（On-demand）：API触发下载

## 技术实现详解

### 资源包创建流程
使用跨平台打包工具（Xcode内置或独立版本）：
```bash
ba-package template  # 生成清单模板
```
编辑JSON配置文件：
```json
{
  "assetPackID": "教程关卡",
  "downloadPolicy": {
    "essential": {
      "installationEventTypes": ["firstInstallation"]
    }
  },
  "fileSelectors": [{
    "file": "Assets/教程开场动画.mp4"
  }],
  "platforms": ["iOS","macOS"]
}
```
关键配置项：
- `assetPackID`：应用内识别的唯一ID
- `downloadPolicy`：定义下载触发条件
- `fileSelectors`：指定包含的文件/目录
- `platforms`：目标平台列表

### 应用集成方案
主应用通过`AssetPackManager` API操作资源：
```swift
// 确保资源可用
let pack = try await AssetPackManager.shared.assetPack(withID: "教程关卡")
try await AssetPackManager.shared.ensureLocalAvailability(of: pack)

// 访问资源内容
let videoData = try AssetPackManager.shared.contents(at: "Assets/教程开场动画.mp4")
```

开发者可选择：
- **零代码集成**：使用系统预制扩展
- **自定义逻辑**：覆写`shouldDownload(_:)`方法

## 测试与分发实践

### 本地测试方案
1. 配置模拟服务器（支持macOS/Linux/Windows）
2. 在设备开发者设置中输入测试服务器地址
3. 验证下载流程与资源访问

### Apple 托管服务部署
上传途径对比：
| 方法 | 适用场景 | 特点 |
|------|---------|------|
| Transporter应用 | 手动操作 | 拖拽.aar文件可视化上传 |
| App Store Connect API | 自动化流程 | 分三步创建记录并上传 |

API调用序列：
1. `POST /backgroundAssets` 创建资源包记录
2. `POST /backgroundAssetVersions` 创建版本
3. `PATCH /backgroundAssetUploadFiles` 上传文件

## 关键注意事项
1. **版本管理**：同一上下文仅生效最新资源包版本
2. **兼容性**：资源更新会影响所有用户（包括旧版应用）
3. **审核策略**：可指定资源包与应用版本的组合提交

## 结论与建议
Background Assets 技术为应用资源管理带来了质的飞跃，特别适合：
- 大型游戏的多关卡交付
- 频繁更新的媒体内容
- 机器学习模型等动态资源

推荐行动路线：
1. 使用打包工具创建测试资源包
2. 评估现有资源交付方案的迁移路径
3. 充分利用200GB免费托管空间（Apple开发者计划会员）

## 相关视频
- [借助 App Store Connect API 实现开发流程自动化](https://developer.apple.com/videos/play/wwdc2025/324)  
- [App Store Connect 的新功能](https://developer.apple.com/videos/play/wwdc2025/328)  
- [Background Assets 的新动向](https://developer.apple.com/videos/play/wwdc2023/10108)  

## 文档
- [配置 Background Assets 项目](https://developer.apple.com/documentation/BackgroundAssets/configuring-background-assets)  
- [最大构建文件尺寸](https://developer.apple.com/help/app-store-connect/reference/maximum-build-file-sizes)  
- [Apple 托管资源包概述](https://developer.apple.com/help/app-store-connect/manage-asset-packs/overview-of-apple-hosted-asset-packs)
> 此文章由AI生成，可能存在错误，如有问题，请联系[djs66256@163.com](djs66256@163.com)
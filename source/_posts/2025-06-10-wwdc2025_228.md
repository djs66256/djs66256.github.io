---
title: 借助 Wi-Fi Aware 增强设备连接性能
date: 2025-06-10 15:52:59
categories:
- wwdc2025
tags:
- wwdc2025
- ios
- ipados
- macos
- tvos
- visionos
- watchos
- 隐私与安全
---
了解如何使用 wi-fi aware 建立对等网络连接。我们还将介绍如何以带宽更高、延迟更低的网络连接性能实时共享视频、传输大文件，以及操控配件。此外，你将了解如何借助 devicediscoveryui、accessorysetupkit 和 network 框架，在自己的 app 中使用 wi-fi aware。
<!--more-->

![视频封面](https://devimages-cdn.apple.com/wwdc-services/images/3055294D-836B-4513-B7B0-0BC5666246B0/9922/9922_wide_250x141_2x.jpg)
[视频地址](https://developer.apple.com/cn/videos/play/wwdc2025/228/)

# 使用 Wi-Fi Aware 实现高效设备点对点连接

## 引言
在当今互联设备激增的时代，Wi-Fi Aware 技术为开发者提供了一种创新的点对点连接解决方案。这项技术允许设备直接通信，无需依赖传统路由器或中心服务器，特别适合需要高带宽、低延迟的应用场景。本文将全面介绍如何在 iOS 应用中集成 Wi-Fi Aware 功能，从基础概念到实际实现。

## Wi-Fi Aware 技术概览
Wi-Fi Aware 实现了设备间的直接通信，具有以下核心优势：
- **动态连接建立**：设备在运行时相互发现并形成安全链接
- **并行工作能力**：可与常规 Wi-Fi 连接同时使用
- **全球标准**：由 Wi-Fi 联盟维护，确保跨平台互操作性

典型应用场景包括：
- 高速文件传输
- 实时媒体流传输
- 配件控制
- 屏幕共享

## 实现 Wi-Fi Aware 的核心概念
### 服务配置
Wi-Fi Aware 使用"服务"概念来发现和连接设备：
- 服务名称规范：
  - 仅含字母、数字和短划线
  - 不超过15个字符
  - 建议在 IANA 注册以避免命名冲突
- 服务角色：
  - 发布者（服务器角色）
  - 订阅者（客户端角色）

在 Info.plist 中的配置示例：
```xml
<key>WiFiAwareServices</key>
<dict>
    <key>com.example.fileservice</key>
    <dict>
        <key>WAPublishable</key>
        <true/>
        <key>WASubscribable</key>
        <true/>
    </dict>
    <key>com.example.drone</key>
    <dict>
        <key>WASubscribable</key>
        <true/>
    </dict>
</dict>
```

设备兼容性检查：
```swift
import WiFiAware
guard WACapabilities.supportedFeatures.contains(.wifiAware) else { 
    // 处理设备不支持情况
    return 
}
```

## 设备配对流程
Wi-Fi Aware 提供两种配对框架：
1. **DeviceDiscoveryUI**：
   - 适用于应用间或应用对设备连接
   - 支持 Apple 和第三方设备
2. **AccessorySetupKit**：
   - 专为配件制造商设计
   - 推荐用于多传输配件

### 使用 DeviceDiscoveryUI 的代码示例
发布方代码：
```swift
let pairingView = DevicePairingView(
    configuration: DevicePairingConfiguration(
        serviceIdentifier: "com.example.fileservice",
        deviceName: "My Device"
    )
)
// 显示配对界面
```

订阅方代码：
```swift
let picker = DevicePicker(
    configuration: DevicePickerConfiguration(
        serviceIdentifier: "com.example.fileservice"
    )
)
// 显示设备选择界面
```

## 建立连接
连接建立的三个关键步骤：

1. **设备筛选**：
   - 使用谓词筛选目标设备
   ```swift
   let predicate = NSPredicate(format: "name BEGINSWITH 'iPhone'")
   ```

2. **创建监听器/浏览器**：
   ```swift
   let listener = try NetworkListener(
       service: "com.example.fileservice_tcp",
       devicePredicate: predicate
   )
   ```

3. **启动连接**：
   ```swift
   listener.start(queue: .main)
   // 处理连接请求
   ```

## 性能优化技巧
1. **调整性能模式**：
   - 批量模式：节能但延迟较高
   - 实时模式：低延迟但耗电较高

2. **设置服务等级**：
   - 尽力服务(Best Effort)
   - 交互式视频(Interactive Video)
   - 语音(Voice)

性能监控示例：
```swift
connection.currentPath?.performanceReport?.throughput
connection.currentPath?.performanceReport?.latency
```

## 结论
Wi-Fi Aware 为开发者提供了强大的点对点连接能力，特别适合需要高带宽、低延迟的应用场景。通过合理配置服务和优化连接参数，您可以打造出色的用户体验。建议参考官方文档和示例代码进一步探索这项技术的潜力。

## 相关视频
- [了解 AccessorySetupKit](https://developer.apple.com/videos/play/wwdc2024/10203)

## 文档
- [Wi-Fi Aware 官方文档](https://developer.apple.com/documentation/WiFiAware)
> 此文章由AI生成，可能存在错误，如有问题，请联系[djs66256@163.com](djs66256@163.com)